var SimplexNoise=function(n){var t;for(n==undefined&&(n=Math),this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[],t=0;t<256;t++)this.p[t]=Math.floor(n.random()*256);for(this.perm=[],t=0;t<512;t++)this.perm[t]=this.p[t&255];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]};SimplexNoise.prototype.dot=function(n,t,i){return n[0]*t+n[1]*i};SimplexNoise.prototype.dot3=function(n,t,i,r){return n[0]*t+n[1]*i+n[2]*r};SimplexNoise.prototype.dot4=function(n,t,i,r,u){return n[0]*t+n[1]*i+n[2]*r+n[3]*u};SimplexNoise.prototype.noise=function(n,t){var c,l,a,it=.5*(Math.sqrt(3)-1),nt=(n+t)*it,v=Math.floor(n+nt),y=Math.floor(t+nt),e=(3-Math.sqrt(3))/6,tt=(v+y)*e,rt=v-tt,ut=y-tt,i=n-rt,r=t-ut,s,h,u,f;i>r?(s=1,h=0):(s=0,h=1);var p=i-s+e,w=r-h+e,b=i-1+2*e,k=r-1+2*e,d=v&255,g=y&255,ft=this.perm[d+this.perm[g]]%12,et=this.perm[d+s+this.perm[g+h]]%12,ot=this.perm[d+1+this.perm[g+1]]%12,o=.5-i*i-r*r;return o<0?c=0:(o*=o,c=o*o*this.dot(this.grad3[ft],i,r)),u=.5-p*p-w*w,u<0?l=0:(u*=u,l=u*u*this.dot(this.grad3[et],p,w)),f=.5-b*b-k*k,f<0?a=0:(f*=f,a=f*f*this.dot(this.grad3[ot],b,k)),70*(c+l+a)};SimplexNoise.prototype.noise3d=function(n,t,i){var g,nt,tt,it,rt=(n+t+i)*(1/3),ut=Math.floor(n+rt),ft=Math.floor(t+rt),et=Math.floor(i+rt),r=1/6,ot=(ut+ft+et)*r,bt=ut-ot,kt=ft-ot,dt=et-ot,f=n-bt,e=t-kt,u=i-dt,o,s,h,c,l,a,v,y,p;f>=e?e>=u?(o=1,s=0,h=0,c=1,l=1,a=0):f>=u?(o=1,s=0,h=0,c=1,l=0,a=1):(o=0,s=0,h=1,c=1,l=0,a=1):e<u?(o=0,s=0,h=1,c=0,l=1,a=1):f<u?(o=0,s=1,h=0,c=0,l=1,a=1):(o=0,s=1,h=0,c=1,l=1,a=0);var st=f-o+r,ht=e-s+r,ct=u-h+r,lt=f-c+2*r,at=e-l+2*r,vt=u-a+2*r,yt=f-1+3*r,pt=e-1+3*r,wt=u-1+3*r,b=ut&255,k=ft&255,d=et&255,gt=this.perm[b+this.perm[k+this.perm[d]]]%12,ni=this.perm[b+o+this.perm[k+s+this.perm[d+h]]]%12,ti=this.perm[b+c+this.perm[k+l+this.perm[d+a]]]%12,ii=this.perm[b+1+this.perm[k+1+this.perm[d+1]]]%12,w=.6-f*f-e*e-u*u;return w<0?g=0:(w*=w,g=w*w*this.dot3(this.grad3[gt],f,e,u)),v=.6-st*st-ht*ht-ct*ct,v<0?nt=0:(v*=v,nt=v*v*this.dot3(this.grad3[ni],st,ht,ct)),y=.6-lt*lt-at*at-vt*vt,y<0?tt=0:(y*=y,tt=y*y*this.dot3(this.grad3[ti],lt,at,vt)),p=.6-yt*yt-pt*pt-wt*wt,p<0?it=0:(p*=p,it=p*p*this.dot3(this.grad3[ii],yt,pt,wt)),32*(g+nt+tt+it)};SimplexNoise.prototype.noise4d=function(n,t,i,r){var w=this.grad4,e=this.simplex,u=this.perm,di=(Math.sqrt(5)-1)/4,f=(5-Math.sqrt(5))/20,rt,ut,ft,et,ot,tt=(n+t+i+r)*di,st=Math.floor(n+tt),ht=Math.floor(t+tt),ct=Math.floor(i+tt),lt=Math.floor(r+tt),it=(st+ht+ct+lt)*f,gi=st-it,nr=ht-it,tr=ct-it,ir=lt-it,s=n-gi,h=t-nr,c=i-tr,l=r-ir,rr=s>h?32:0,ur=s>c?16:0,fr=h>c?8:0,er=s>l?4:0,or=h>l?2:0,sr=c>l?1:0,o=rr+ur+fr+er+or+sr,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,a,v,y,p;at=e[o][0]>=3?1:0;vt=e[o][1]>=3?1:0;yt=e[o][2]>=3?1:0;pt=e[o][3]>=3?1:0;wt=e[o][0]>=2?1:0;bt=e[o][1]>=2?1:0;kt=e[o][2]>=2?1:0;dt=e[o][3]>=2?1:0;gt=e[o][0]>=1?1:0;ni=e[o][1]>=1?1:0;ti=e[o][2]>=1?1:0;ii=e[o][3]>=1?1:0;var ri=s-at+f,ui=h-vt+f,fi=c-yt+f,ei=l-pt+f,oi=s-wt+2*f,si=h-bt+2*f,hi=c-kt+2*f,ci=l-dt+2*f,li=s-gt+3*f,ai=h-ni+3*f,vi=c-ti+3*f,yi=l-ii+3*f,pi=s-1+4*f,wi=h-1+4*f,bi=c-1+4*f,ki=l-1+4*f,b=st&255,k=ht&255,d=ct&255,g=lt&255,hr=u[b+u[k+u[d+u[g]]]]%32,cr=u[b+at+u[k+vt+u[d+yt+u[g+pt]]]]%32,lr=u[b+wt+u[k+bt+u[d+kt+u[g+dt]]]]%32,ar=u[b+gt+u[k+ni+u[d+ti+u[g+ii]]]]%32,vr=u[b+1+u[k+1+u[d+1+u[g+1]]]]%32,nt=.6-s*s-h*h-c*c-l*l;return nt<0?rt=0:(nt*=nt,rt=nt*nt*this.dot4(w[hr],s,h,c,l)),a=.6-ri*ri-ui*ui-fi*fi-ei*ei,a<0?ut=0:(a*=a,ut=a*a*this.dot4(w[cr],ri,ui,fi,ei)),v=.6-oi*oi-si*si-hi*hi-ci*ci,v<0?ft=0:(v*=v,ft=v*v*this.dot4(w[lr],oi,si,hi,ci)),y=.6-li*li-ai*ai-vi*vi-yi*yi,y<0?et=0:(y*=y,et=y*y*this.dot4(w[ar],li,ai,vi,yi)),p=.6-pi*pi-wi*wi-bi*bi-ki*ki,p<0?ot=0:(p*=p,ot=p*p*this.dot4(w[vr],pi,wi,bi,ki)),27*(rt+ut+ft+et+ot)};